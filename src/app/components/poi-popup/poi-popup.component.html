<ng-container *ngIf="poiProperties!= null">
  <ng-container>
    <webmapp-image-modal
      *ngIf="toggleImage$|async as image"
      (closeEVT)="toggleImage()"
      [image]="image"
    ></webmapp-image-modal>
  </ng-container>
  <div class="row">
    <button class="webmapp-poi-popup-close" (click)="closeEVT.emit()">
      <i class="icn-outline-close"></i>
    </button>
  </div>
  <div
    class="row category"
    *ngIf="poiProperties.taxonomy && poiProperties.taxonomy.poi_type as poiType"
    [innerHTML]="poiType.name|wmtrans"
  ></div>
  <div class="row">
    <div class="title">
      <button
        class="webmapp-poi-popup-left circle"
        *ngIf="poiProperties.related"
        (click)="prevEVT.emit()"
      >
        <i class="icn-outline-arrow-left"></i>
      </button>
      <p class="webmapp-poi-popup-title">{{poiProperties.name|wmtrans}}</p>

      <button
        class="webmapp-poi-popup-right circle"
        (click)="nextEVT.emit()"
        *ngIf="poiProperties.related"
      >
        <i class="icn-outline-arrow-right"></i>
      </button>
    </div>
  </div>

  <div class="row gallery" *ngIf="poiProperties.feature_image !=null">
    <ion-slides #gallery class="gallery" [options]="slideOptions">
      <ion-slide
        pager="true"
        (click)="toggleImage(poiProperties.feature_image !=null? poiProperties.feature_image.url:defaultPhotoPath)"
      >
        <img
          class="webmapp-poi-popup-img"
          [src]="poiProperties.feature_image !=null? poiProperties.feature_image.url:defaultPhotoPath"
        />
      </ion-slide>
      <ion-slide
        *ngFor="let image of poiProperties.image_gallery"
        pager="true"
        (click)="toggleImage(image.url)"
      >
        <img [src]="image.url" class="webmapp-poi-popup-img" />
      </ion-slide>
      <ng-container
        *ngIf="poiProperties.image_gallery!= null && poiProperties.image_gallery.length > 0"
      >
        <button
          type="submit"
          ion-button
          class="webmapp-poi-popup-left left circle"
          (click)="prev()"
        >
          <ion-icon name="caret-back-outline"></ion-icon>
        </button>
        <button
          type="submit"
          ion-button
          class="webmapp-poi-popup-right right circle"
          (click)="next()"
        >
          <ion-icon name="caret-forward-outline"></ion-icon>
        </button>
      </ng-container>
    </ion-slides>
  </div>
  <div class="webmapp-poi-popup-btns">
    <div class="webmapp-poi-popup-btn" *ngIf="poiProperties.address">
      <i class="wm-icn icn-fill-pin"></i>
      <a
        href="https://www.google.com/maps?daddr={{poiProperties.address_link}}&navigate=yes"
        target="_blank"
      >
        {{poiProperties.address}}
      </a>
    </div>
    <div class="webmapp-poi-popup-btn" *ngIf="poiProperties.ele">
      <i class="wm-icn icn-outline-plus"></i>
      <p>
        <a> {{poiProperties.ele}} {{'metri'|wmtrans}} </a>
      </p>
    </div>
    <div class="webmapp-poi-popup-btn" *ngIf="poiProperties.contact_phone" target="_blank">
      <i class="wm-icn icn-fill-phone"></i>
      <p>
        <a href="tel:{{poiProperties.contact_email}}">
          {{poiProperties.contact_phone}}
        </a>
      </p>
    </div>
    <div class="webmapp-poi-popup-btn" *ngIf="poiProperties.contact_email" target="_blank">
      <i class="wm-icn icn-fill-mail"></i>
      <a [href]="poiProperties.contact_email">
        {{poiProperties.contact_email}}
      </a>
    </div>
    <div class="webmapp-poi-popup-btn" *ngIf="poiProperties.related_url != null">
      <i class="wm-icn icn-fill-globe"></i>
      <webmapp-related-urls [relatedUrls]="poiProperties.related_url"></webmapp-related-urls>
    </div>
    <div *ngIf="poiProperties.osm_url as osm" target="_blank">
      <ion-icon class="wm-icn icn-link" slot="start"> </ion-icon>
      <a class="webmapp-track-download-urls-item-label" [href]="osm">
        {{ "Vedi su OpenStreetMap" | wmtrans }}
      </a>
    </div>
  </div>

  <div class="webmapp-poi-popup-text" [innerHTML]="poiProperties.description|wmtrans"></div>

  <ng-container *ngIf="poiProperties?.audio">
    <div class="webmapp-title">{{'Descrizione Audio'|wmtrans}}</div>
    <webmapp-track-audio [audio]="poiProperties?.audio"></webmapp-track-audio>
  </ng-container>
  <ion-button class="edit" *ngIf="enableEditingInline$|async" (click)="openGeohub()">
    edit geohub</ion-button
  >
</ng-container>
